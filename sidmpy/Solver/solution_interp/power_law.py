import numpy as np
from scipy.interpolate import RegularGridInterpolator

"""
See documentation in function at the bottom of this file.
"""

logrho_vpower0 = np.array([[[9.8,  9.3097,  8.9086,  8.6275,  8.4961,  8.4034,  8.3466],
        [ 9.8405,  9.3351,  8.9993,  8.7425,  8.6061,  8.5326,  8.4654],
        [ 9.8848,  9.4189,  9.1054,  8.8307,  8.7045,  8.62  ,  8.5638],
        [10.0093,  9.5129,  9.1681,  8.9113,  8.7839,  8.7037,  8.6342],
        [    10.0125,  9.6019,  9.2545,  8.9731,  8.8501,  8.7712,  8.699],
        [    10.02,  9.6824,  9.3228,  9.0415,  8.9168,  8.8241,  8.7583],
        [    10.025,  9.7833,  9.3999,  9.1076,  8.9366,  8.8829,  8.8175],
        [    10.05,  9.849 ,  9.4623,  9.1755,  9.013 ,  8.9213,  8.86],
        [    10.1,  9.9458,  9.5404,  9.2128,  9.0759,  8.9668,  8.9041],
        [    10.15, 10.0558,  9.6063,  9.2974,  9.1181,  8.9802,  8.9489],
        [    10.2, 10.1518,  9.6553,  9.3106,  9.1577,  9.0627,  8.9934]],

       [[ 9.5861,  9.0852,  8.7449,  8.4882,  8.3607,  8.2805,  8.211 ],
        [ 9.5929,  9.1611,  8.8444,  8.6004,  8.4825,  8.397 ,  8.3497],
        [ 9.6164,  9.2452,  8.9429,  8.6977,  8.5823,  8.5033,  8.4415],
        [ 9.7622,  9.3324,  9.0204,  8.7786,  8.664 ,  8.5795,  8.5234],
        [ 9.8501,  9.4178,  9.0977,  8.823 ,  8.7238,  8.6426,  8.5853],
        [10.0085,  9.5031,  9.1673,  8.9016,  8.7741,  8.7006,  8.6334],
        [    10.02,  9.5823,  9.2349,  8.9535,  8.8305,  8.7517,  8.6794],
        [    10.045,  9.6535,  9.2916,  9.0202,  8.8834,  8.7951,  8.7261],
        [    10.07,  9.7302,  9.3664,  9.0674,  8.9031,  8.8405,  8.7718],
        [    10.15,  9.8142,  9.4198,  9.1252,  8.9692,  8.8775,  8.8186],
        [    10.25,  9.9115,  9.4752,  9.1697,  9.0107,  8.9279,  8.8564]],

       [[ 9.3355,  8.9057,  8.6002,  8.3564,  8.2373,  8.1528,  8.0967],
        [ 9.3915,  8.9903,  8.698 ,  8.4664,  8.3511,  8.2828,  8.2352],
        [ 9.4625,  9.0836,  8.789 ,  8.5652,  8.4454,  8.3825,  8.3417],
        [ 9.5198,  9.1603,  8.8679,  8.6453,  8.532 ,  8.458 ,  8.4017],
        [ 9.6493,  9.2394,  8.9516,  8.7037,  8.5912,  8.5197,  8.4634],
        [ 9.76  ,  9.3215,  9.0115,  8.7675,  8.6496,  8.5641,  8.5168],
        [ 9.8297,  9.3974,  9.0772,  8.8026,  8.7034,  8.6222,  8.5649],
        [ 9.9638,  9.4694,  9.138 ,  8.8723,  8.7448,  8.6714,  8.6041],
        [    10.05,  9.5336,  9.1547,  8.9202,  8.7883,  8.7184,  8.6461],
        [    10.15,  9.6039,  9.2421,  8.9784,  8.8403,  8.7545,  8.6855],
        [    10.25,  9.673 ,  9.3047,  9.0217,  8.87  ,  8.7863,  8.7322]],

       [[ 9.1084,  8.7447,  8.4457,  8.2188,  8.101 ,  8.0315,  7.9751],
        [ 9.1636,  8.7847,  8.5502,  8.3484,  8.2298,  8.1613,  8.1127],
        [ 9.2362,  8.8915,  8.6436,  8.4365,  8.3244,  8.2583,  8.2152],
        [ 9.3344,  8.9555,  8.7211,  8.5192,  8.4051,  8.3321,  8.288 ],
        [ 9.4299,  9.068 ,  8.8043,  8.5805,  8.4629,  8.4011,  8.3515],
        [ 9.5578,  9.1566,  8.8643,  8.6327,  8.5173,  8.4491,  8.4015],
        [ 9.628 ,  9.2182,  8.9303,  8.6824,  8.5699,  8.4984,  8.4421],
        [ 9.6478,  9.2897,  8.982 ,  8.738 ,  8.6201,  8.5346,  8.485 ],
        [ 9.7488,  9.3511,  9.0379,  8.7697,  8.6638,  8.5783,  8.5198],
        [ 9.8689,  9.4184,  9.105 ,  8.8303,  8.704 ,  8.6196,  8.5633],
        [ 9.9645,  9.468 ,  9.1233,  8.8754,  8.7524,  8.6683,  8.6025]],

       [[ 8.929 ,  8.5826,  8.3112,  8.0894,  7.9753,  7.9124,  7.8519],
        [ 8.9876,  8.6697,  8.3883,  8.2079,  8.1097,  8.0426,  7.9921],
        [ 9.0725,  8.7637,  8.4955,  8.3042,  8.206 ,  8.1407,  8.0884],
        [ 9.1685,  8.8417,  8.5603,  8.3799,  8.2817,  8.2134,  8.1641],
        [ 9.2512,  8.9199,  8.6541,  8.441 ,  8.343 ,  8.2733,  8.2204],
        [ 9.3292,  8.9502,  8.7113,  8.5017,  8.3953,  8.3268,  8.2782],
        [ 9.4077,  9.0459,  8.7822,  8.5583,  8.4408,  8.379 ,  8.3294],
        [ 9.5282,  9.1193,  8.8325,  8.6031,  8.4878,  8.4195,  8.3632],
        [ 9.5648,  9.1706,  8.8792,  8.6503,  8.5313,  8.4618,  8.4099],
        [ 9.6162,  9.2295,  8.9427,  8.6886,  8.5793,  8.4954,  8.4413],
        [ 9.7197,  9.2899,  8.9844,  8.7406,  8.6215,  8.5371,  8.481 ]],

       [[ 8.748 ,  8.4345,  8.1598,  7.9491,  7.8509,  7.7869,  7.7308],
        [ 8.8136,  8.5268,  8.2726,  8.0794,  7.9892,  7.9174,  7.8715],
        [ 8.8983,  8.606 ,  8.376 ,  8.1786,  8.0791,  8.0201,  7.977 ],
        [ 8.9949,  8.6849,  8.4462,  8.2508,  8.1703,  8.091 ,  8.0452],
        [ 9.0706,  8.765 ,  8.5213,  8.3177,  8.215 ,  8.1545,  8.1054],
        [ 9.1571,  8.829 ,  8.5533,  8.3729,  8.2747,  8.2009,  8.1571],
        [ 9.2283,  8.897 ,  8.6312,  8.4181,  8.3202,  8.2504,  8.1976],
        [ 9.302 ,  8.9209,  8.682 ,  8.4724,  8.366 ,  8.2975,  8.2456],
        [ 9.3613,  9.0227,  8.7368,  8.5207,  8.4098,  8.3371,  8.2875],
        [ 9.4634,  9.069 ,  8.7877,  8.5593,  8.4462,  8.3712,  8.3348],
        [ 9.481 ,  9.1215,  8.8291,  8.5975,  8.4822,  8.4139,  8.3663]],

       [[ 8.577 ,  8.2649,  8.0232,  7.8241,  7.7214,  7.6675,  7.6117],
        [ 8.6548,  8.368 ,  8.1386,  7.955 ,  7.8598,  7.8055,  7.7524],
        [ 8.7426,  8.4613,  8.2396,  8.0481,  7.971 ,  7.8943,  7.8591],
        [ 8.8251,  8.5373,  8.3067,  8.1263,  8.0368,  7.9668,  7.9282],
        [ 8.9147,  8.6092,  8.3778,  8.186 ,  8.0968,  8.0287,  7.9869],
        [ 8.9875,  8.6775,  8.4388,  8.2434,  8.1551,  8.0791,  8.0345],
        [ 9.0485,  8.7364,  8.4947,  8.2956,  8.1929,  8.139 ,  8.0832],
        [ 9.1208,  8.8006,  8.5259,  8.3345,  8.2364,  8.1788,  8.1265],
        [ 9.1782,  8.8692,  8.5945,  8.3838,  8.2856,  8.2206,  8.1655],
        [ 9.2361,  8.8958,  8.639 ,  8.4314,  8.3243,  8.2594,  8.2041],
        [ 9.2891,  8.9233,  8.6844,  8.4749,  8.3685,  8.2989,  8.2436]],

       [[ 8.4042,  8.1128,  7.8839,  7.6954,  7.6017,  7.5337,  7.4873],
        [ 8.5014,  8.2247,  8.0082,  7.8312,  7.7298,  7.675 ,  7.6288],
        [ 8.5478,  8.3089,  8.0994,  7.9244,  7.8345,  7.7694,  7.7363],
        [ 8.6636,  8.3822,  8.1803,  7.9999,  7.911 ,  7.8459,  7.8128],
        [ 8.7355,  8.4664,  8.2435,  8.0576,  7.9649,  7.9038,  7.8674],
        [ 8.8188,  8.5242,  8.3004,  8.1177,  8.0228,  7.9627,  7.9164],
        [ 8.8797,  8.5807,  8.3538,  8.1665,  8.074 ,  8.006 ,  7.9629],
        [ 8.9333,  8.641 ,  8.411 ,  8.2135,  8.1141,  8.0551,  8.012 ],
        [ 9.002 ,  8.692 ,  8.4545,  8.2601,  8.1619,  8.0869,  8.049 ],
        [ 9.0506,  8.7451,  8.5034,  8.3043,  8.2016,  8.1477,  8.0986],
        [ 9.1136,  8.7859,  8.5399,  8.3463,  8.2504,  8.1774,  8.125 ]],

       [[ 8.2518,  7.9705,  7.7489,  7.5573,  7.4802,  7.4035,  7.3683],
        [ 8.3384,  8.0727,  7.8717,  7.6919,  7.6053,  7.5525,  7.5149],
        [ 8.45  ,  8.1328,  7.9646,  7.7936,  7.7037,  7.6486,  7.6087],
        [ 8.521 ,  8.2464,  8.0357,  7.8802,  7.7825,  7.7274,  7.6831],
        [ 8.5718,  8.315 ,  8.114 ,  7.9473,  7.8397,  7.7935,  7.7448],
        [ 8.6123,  8.3734,  8.1638,  7.9889,  7.8989,  7.8339,  7.8008],
        [ 8.7121,  8.4418,  8.2189,  8.042 ,  7.945 ,  7.889 ,  7.8441],
        [ 8.7703,  8.4989,  8.2739,  8.088 ,  8.0032,  7.9309,  7.8945],
        [ 8.8364,  8.5418,  8.318 ,  8.1353,  8.0404,  7.9803,  7.9339],
        [ 8.8859,  8.5936,  8.362 ,  8.1784,  8.0877,  8.0221,  7.9736],
        [ 8.9314,  8.6401,  8.4132,  8.2214,  8.1279,  8.0609,  8.019 ]]])

logrho_vpower25 = np.array([[[9.1429, 8.8133, 8.5744, 8.377 , 8.2694, 8.2066, 8.146 ],
        [9.2314, 8.9503, 8.6821, 8.5017, 8.4036, 8.343 , 8.2834],
        [9.3266, 9.0343, 8.7883, 8.6079, 8.5097, 8.4414, 8.3965],
        [9.4246, 9.1267, 8.8845, 8.6827, 8.5868, 8.5205, 8.461 ],
        [9.5031, 9.2075, 8.9597, 8.759 , 8.6526, 8.5841, 8.5323],
        [9.5852, 9.2752, 9.027 , 8.8131, 8.7   , 8.6382, 8.5864],
        [9.8491, 9.3403, 9.0834, 8.8605, 8.7562, 8.6822, 8.6303],
        [9.7663, 9.416 , 9.1401, 8.9124, 8.8014, 8.7259, 8.6741],
        [9.7804, 9.4687, 9.1973, 8.9668, 8.8476, 8.7632, 8.7124],
        [9.8765, 9.5295, 9.2483, 8.9802, 8.8875, 8.812 , 8.7534],
        [9.942 , 9.5927, 9.2966, 9.0538, 8.9263, 8.8511, 8.7898]],

       [[9.0092, 8.7449, 8.4792, 8.2783, 8.1734, 8.1128, 8.0532],
        [9.1157, 8.8289, 8.6004, 8.4102, 8.3076, 8.2582, 8.1979],
        [9.2066, 8.9275, 8.6977, 8.5033, 8.4138, 8.3455, 8.3076],
        [9.3005, 9.0137, 8.7831, 8.5917, 8.4891, 8.425 , 8.3759],
        [9.378 , 9.0977, 8.823 , 8.6548, 8.5544, 8.4916, 8.4365],
        [9.4629, 9.1673, 8.9105, 8.7123, 8.6124, 8.5429, 8.4876],
        [9.5392, 9.1879, 8.98  , 8.7649, 8.654 , 8.5922, 8.5426],
        [9.7826, 9.2916, 9.0279, 8.8118, 8.6965, 8.6335, 8.5771],
        [9.6687, 9.351 , 9.0763, 8.8539, 8.7414, 8.6699, 8.6135],
        [9.743 , 9.4043, 9.1406, 8.9044, 8.7865, 8.701 , 8.6581],
        [9.8288, 9.4707, 9.1784, 8.9324, 8.8287, 8.752 , 8.6947]],

       [[8.8947, 8.6024, 8.3564, 8.176 , 8.0778, 8.004 , 7.9602],
        [8.9903, 8.7157, 8.4932, 8.3092, 8.213 , 8.1567, 8.0991],
        [9.0836, 8.8132, 8.5908, 8.4112, 8.3185, 8.2527, 8.2109],
        [9.1757, 8.9111, 8.6721, 8.4857, 8.3976, 8.3224, 8.28  ],
        [9.2549, 8.9835, 8.7529, 8.5494, 8.4601, 8.3871, 8.338 ],
        [9.3359, 9.0556, 8.7809, 8.6127, 8.5123, 8.4495, 8.3899],
        [9.4064, 9.1058, 8.863 , 8.6648, 8.5527, 8.4953, 8.4368],
        [9.4696, 9.138 , 8.9248, 8.7082, 8.6041, 8.5313, 8.4894],
        [9.7303, 9.2258, 8.9754, 8.7537, 8.6461, 8.5734, 8.5215],
        [9.6039, 9.2884, 9.018 , 8.7956, 8.6855, 8.616 , 8.5597],
        [9.6836, 9.3411, 9.0774, 8.8387, 8.7322, 8.6532, 8.5947]],

       [[8.7679, 8.5042, 8.259 , 8.0646, 7.9751, 7.9213, 7.8722],
        [8.8713, 8.6076, 8.3915, 8.2131, 8.1249, 8.0494, 8.0063],
        [8.9626, 8.7057, 8.4906, 8.3102, 8.2195, 8.1651, 8.1121],
        [9.0575, 8.7939, 8.5712, 8.3884, 8.2959, 8.2312, 8.1893],
        [9.143 , 8.8761, 8.6394, 8.4529, 8.3724, 8.2932, 8.2473],
        [9.2107, 8.9393, 8.7087, 8.5051, 8.4192, 8.3474, 8.2938],
        [9.2866, 8.9998, 8.7316, 8.5634, 8.4563, 8.4002, 8.3406],
        [9.3597, 9.0546, 8.8118, 8.6136, 8.5015, 8.4354, 8.3923],
        [9.4185, 9.0869, 8.8524, 8.6571, 8.5452, 8.4801, 8.4306],
        [9.6432, 9.1706, 8.9202, 8.6951, 8.5842, 8.5192, 8.4806],
        [9.7206, 9.2253, 8.9594, 8.739 , 8.6257, 8.5562, 8.4999]],

       [[8.6499, 8.3752, 8.1528, 7.9688, 7.8726, 7.8077, 7.7619],
        [8.7524, 8.5075, 8.2891, 8.1097, 8.0282, 7.9559, 7.915 ],
        [8.8127, 8.6047, 8.3896, 8.206 , 8.1133, 8.0554, 8.019 ],
        [8.9409, 8.685 , 8.4676, 8.285 , 8.2012, 8.1357, 8.0992],
        [9.0219, 8.756 , 8.5356, 8.3528, 8.2603, 8.1955, 8.1492],
        [9.0964, 8.8294, 8.5928, 8.4063, 8.3138, 8.2465, 8.2007],
        [9.1749, 8.8881, 8.6575, 8.454 , 8.368 , 8.2962, 8.2427],
        [9.2284, 8.9473, 8.6791, 8.5077, 8.4005, 8.3445, 8.2849],
        [9.2943, 9.0027, 8.7509, 8.555 , 8.4496, 8.3803, 8.3327],
        [9.3505, 9.037 , 8.7981, 8.6007, 8.4866, 8.4203, 8.376 ],
        [9.4091, 9.1048, 8.8509, 8.637 , 8.5239, 8.462 , 8.4102]],

       [[8.5366, 8.2707, 8.0502, 7.8674, 7.7749, 7.7102, 7.6638],
        [8.6211, 8.3822, 8.1848, 8.0111, 7.9141, 7.8581, 7.812 ],
        [8.729 , 8.4901, 8.2805, 8.1056, 8.0201, 7.9583, 7.9251],
        [8.7947, 8.5603, 8.3649, 8.188 , 8.0876, 8.0395, 7.9933],
        [8.9019, 8.6459, 8.4286, 8.2526, 8.1555, 8.0899, 8.0602],
        [8.9725, 8.7089, 8.4907, 8.3034, 8.2142, 8.1461, 8.103 ],
        [9.0432, 8.7785, 8.5396, 8.3531, 8.2651, 8.1898, 8.1519],
        [9.1057, 8.8188, 8.6037, 8.4001, 8.3109, 8.2379, 8.1888],
        [9.1739, 8.8801, 8.6266, 8.4462, 8.348 , 8.2842, 8.2279],
        [9.2267, 8.967 , 8.6923, 8.4925, 8.3901, 8.3249, 8.2675],
        [9.2863, 8.9907, 8.7429, 8.5423, 8.4336, 8.3663, 8.311 ]],

       [[8.416 , 8.1523, 7.9439, 7.7635, 7.6696, 7.604 , 7.5654],
        [8.5179, 8.275 , 8.0769, 7.9074, 7.8107, 7.749 , 7.717 ],
        [8.6266, 8.3748, 8.1789, 8.0086, 7.913 , 7.8679, 7.8213],
        [8.7076, 8.4598, 8.2591, 8.0842, 7.9943, 7.9292, 7.8961],
        [8.7531, 8.5187, 8.3233, 8.1464, 8.0459, 8.0011, 7.9517],
        [8.8662, 8.6025, 8.3864, 8.2037, 8.112 , 8.0532, 8.0079],
        [8.9338, 8.6547, 8.4365, 8.2492, 8.1645, 8.0952, 8.0534],
        [8.9893, 8.7223, 8.4857, 8.2992, 8.2067, 8.1394, 8.0935],
        [9.054 , 8.7672, 8.5386, 8.3485, 8.2458, 8.1964, 8.1361],
        [9.1038, 8.8224, 8.5787, 8.3873, 8.2891, 8.2316, 8.1792],
        [9.1555, 8.8743, 8.6062, 8.438 , 8.3308, 8.2703, 8.2164]],

       [[8.3137, 8.0523, 7.8339, 7.6545, 7.573 , 7.5007, 7.4643],
        [8.4379, 8.1633, 7.9591, 7.8058, 7.6982, 7.6553, 7.6109],
        [8.5053, 8.2642, 8.0625, 7.9003, 7.8138, 7.7542, 7.7243],
        [8.6166, 8.3509, 8.1499, 7.9845, 7.8801, 7.8384, 7.7941],
        [8.6643, 8.4165, 8.2159, 8.041 , 7.951 , 7.8892, 7.8573],
        [8.7013, 8.4933, 8.2782, 8.0946, 8.0019, 7.9408, 7.9032],
        [8.8047, 8.5488, 8.3326, 8.15  , 8.0583, 7.9995, 7.9541],
        [8.866 , 8.6023, 8.3842, 8.1969, 8.1076, 8.0396, 7.9965],
        [8.9248, 8.6501, 8.4277, 8.2436, 8.1475, 8.0782, 8.0368],
        [8.9789, 8.7152, 8.4765, 8.291 , 8.1918, 8.1256, 8.0765],
        [9.0419, 8.755 , 8.5265, 8.3363, 8.2337, 8.1843, 8.124 ]],

       [[8.1498, 7.9276, 7.72  , 7.5431, 7.4504, 7.3893, 7.3529],
        [8.2959, 8.0213, 7.853 , 7.6931, 7.6043, 7.5448, 7.5005],
        [8.3863, 8.1328, 7.9524, 7.7904, 7.7004, 7.6453, 7.6043],
        [8.4785, 8.2039, 8.0357, 7.8757, 7.7825, 7.7274, 7.6831],
        [8.5578, 8.306 , 8.1101, 7.9398, 7.8442, 7.7991, 7.7492],
        [8.6123, 8.3734, 8.1638, 7.9889, 7.8964, 7.8416, 7.8085],
        [8.6487, 8.4407, 8.2256, 8.042 , 7.9493, 7.8882, 7.8506],
        [8.7494, 8.4912, 8.2739, 8.0979, 8.0008, 7.9352, 7.8988],
        [8.8055, 8.5418, 8.3257, 8.1421, 8.0546, 7.9791, 7.9405],
        [8.8573, 8.5936, 8.3754, 8.1881, 8.0989, 8.0309, 7.9878],
        [8.9105, 8.6401, 8.4177, 8.2381, 8.1454, 8.0796, 8.0377]]])

logrho_vpower50 = np.array([[[8.7708, 8.5386, 8.3449, 8.1769, 8.0857, 8.0339, 7.994 ],
        [8.8895, 8.6687, 8.4786, 8.3241, 8.2396, 8.1878, 8.1561],
        [8.9957, 8.7748, 8.5847, 8.4257, 8.3457, 8.2939, 8.251 ],
        [   9.089, 8.8509, 8.6705, 8.5085, 8.423 , 8.3667, 8.3224],
        [9.165 , 8.9328, 8.7391, 8.5756, 8.4787, 8.4281, 8.3882],
        [9.234 , 8.9951, 8.7977, 8.6272, 8.5268, 8.482 , 8.4371],
        [9.295 , 9.0612, 8.8528, 8.6769, 8.5862, 8.5207, 8.4709],
        [9.3564, 9.1082, 8.9035, 8.7194, 8.6233, 8.5584, 8.5126],
        [9.4147, 9.1742, 8.9444, 8.7632, 8.6672, 8.6077, 8.5486],
        [9.4821,    9.21, 8.9802, 8.7998, 8.7016, 8.641 , 8.5859],
        [9.5449, 9.2681, 9.0359, 8.8489, 8.7435, 8.6742, 8.6378]],

       [[   8.7, 8.4613, 8.2644, 8.0984, 8.0119, 7.9623, 7.9179],
        [8.8212, 8.5914, 8.4102, 8.2547, 8.1635, 8.1162, 8.0832],
        [8.9275, 8.6977, 8.5165, 8.3498, 8.2698, 8.2224, 8.185 ],
        [   9.0, 8.7831, 8.5917, 8.4392, 8.343 , 8.2911, 8.2513],
        [9.0912, 8.8565, 8.6596, 8.4981, 8.4004, 8.3619, 8.3132],
        [9.1673, 8.9195, 8.731 , 8.5506, 8.4604, 8.4044, 8.3582],
        [9.1879, 8.9899, 8.7781, 8.6021, 8.5094, 8.4538, 8.4152],
        [9.2762, 9.0395, 8.8252, 8.6479, 8.5597, 8.4916, 8.4498],
        [9.3432, 9.0905, 8.8718, 8.6863, 8.5924, 8.5286, 8.4862],
        [9.4043,    9.12, 8.9178, 8.7264, 8.6282, 8.5752, 8.5216],
        [9.4575,    9.17, 8.966 , 8.7642, 8.6728, 8.603 , 8.5502]],

       [[   8.54, 8.381 , 8.1882, 8.026 , 7.9472, 7.8876, 7.85  ],
        [8.7366, 8.5111, 8.3257, 8.1756, 8.0889, 8.0403, 8.0086],
        [8.8476, 8.6176, 8.4322, 8.2888, 8.1954, 8.1468, 8.1107],
        [8.9352, 8.7124, 8.521 , 8.362 , 8.2776, 8.2257, 8.1829],
        [   9.0, 8.7775, 8.5847, 8.4225, 8.3437, 8.2842, 8.2466],
        [9.0981, 8.8413, 8.6496, 8.4747, 8.3822, 8.3274, 8.2943],
        [9.1198, 8.9118, 8.7034, 8.524 , 8.4469, 8.3735, 8.3383],
        [9.2037, 8.961 , 8.7448, 8.571 , 8.4817, 8.4137, 8.3706],
        [9.2722, 9.0107, 8.7972, 8.6108, 8.5183, 8.4475, 8.4084],
        [9.3171, 9.0611, 8.8403, 8.6502, 8.5642, 8.4957, 8.4466],
        [9.372 ,    9.05, 8.87  , 8.6919, 8.5947, 8.5386, 8.479 ]],

       [[   8.5, 8.306 , 8.1132, 7.951 , 7.8689, 7.8093, 7.775 ],
        [8.6639, 8.4362, 8.2507, 8.1029, 8.0095, 7.9621, 7.9292],
        [8.7707, 8.543 , 8.3575, 8.1998, 8.1176, 8.069 , 8.036 ],
        [8.8612, 8.6339, 8.4348, 8.2847, 8.2003, 8.1484, 8.1088],
        [   8.93, 8.6797, 8.5115, 8.3493, 8.2628, 8.2032, 8.1733],
        [9.0259, 8.7691, 8.5709, 8.4025, 8.3125, 8.2507, 8.2188],
        [9.0488, 8.8144, 8.6257, 8.4531, 8.3571, 8.2993, 8.2584],
        [9.132 , 8.8761, 8.6754, 8.5015, 8.4035, 8.3365, 8.2979],
        [9.1822, 8.934 , 8.7205, 8.543 , 8.4547, 8.3787, 8.3341],
        [9.2357, 8.9952, 8.7654, 8.5842, 8.4816, 8.4354, 8.3652],
        [9.2926,    9.05, 8.8061, 8.6257, 8.5275, 8.4605, 8.4041]],

       [[   8.4, 8.2266, 8.0338, 7.8716, 7.7895, 7.73  , 7.6956],
        [8.5847, 8.357 , 8.1715, 8.0237, 7.9303, 7.8829, 7.85  ],
        [8.683 , 8.4642, 8.2788, 8.121 , 8.0343, 7.9902, 7.9573],
        [8.7764, 8.5469, 8.3567, 8.2067, 8.1222, 8.0704, 8.0375],
        [   8.9, 8.6027, 8.4345, 8.2757, 8.1858, 8.1262, 8.0864],
        [8.9502, 8.6845, 8.4952, 8.3258, 8.2368, 8.1718, 8.1387],
        [8.9747, 8.7403, 8.5449, 8.379 , 8.2852, 8.2219, 8.1811],
        [9.0433, 8.8115, 8.5954, 8.4195, 8.332 , 8.2565, 8.2179],
        [9.1033, 8.855 , 8.6414, 8.4618, 8.3669, 8.3008, 8.2562],
        [9.16  , 8.9163, 8.6886, 8.5031, 8.4136, 8.3453, 8.3074],
        [9.2194, 8.9635, 8.7406, 8.5493, 8.4511, 8.3903, 8.3367]],

       [[   8.3, 8.1509, 7.9491, 7.7847, 7.7014, 7.6486, 7.611 ],
        [8.4981, 8.2816, 8.0871, 7.9371, 7.8504, 7.8018, 7.7701],
        [8.6082, 8.3805, 8.195 , 8.0472, 7.9538, 7.9064, 7.8735],
        [8.7004, 8.4731, 8.2862, 8.1227, 8.0427, 7.9876, 7.948 ],
        [   8.8, 8.5213, 8.3531, 8.1976, 8.1043, 8.0448, 8.0149],
        [8.8705, 8.6047, 8.4155, 8.2461, 8.1571, 8.0921, 8.0589],
        [8.897 , 8.6626, 8.4672, 8.2902, 8.1976, 8.1397, 8.1033],
        [8.9621, 8.7284, 8.5199, 8.3396, 8.2533, 8.1878, 8.138 ],
        [9.0304, 8.7799, 8.564 , 8.3889, 8.2962, 8.2444, 8.1886],
        [9.0844, 8.823 , 8.6095, 8.4253, 8.3338, 8.2675, 8.2184],
        [9.1369, 8.881 , 8.6602, 8.47  , 8.3808, 8.3122, 8.2587]],

       [[8.2958, 8.0612, 7.8687, 7.7127, 7.6083, 7.5599, 7.5223],
        [8.4221, 8.2013, 8.0111, 7.8489, 7.7689, 7.717 , 7.6774],
        [8.5308, 8.301 , 8.1198, 7.971 , 7.8731, 7.8258, 7.7884],
        [8.6133, 8.3905, 8.1991, 8.0433, 7.9471, 7.8841, 7.8609],
        [   8.7, 8.4605, 8.2677, 8.1055, 8.0235, 7.9627, 7.9296],
        [8.7873, 8.5305, 8.3323, 8.1639, 8.0739, 8.0134, 7.9802],
        [8.8163, 8.5819, 8.3865, 8.2096, 8.1169, 8.0591, 8.0227],
        [8.8844, 8.6506, 8.4422, 8.2618, 8.1711, 8.11  , 8.057 ],
        [8.9404, 8.6988, 8.4894, 8.3021, 8.2206, 8.1558, 8.1095],
        [8.9979, 8.7497, 8.5295, 8.3519, 8.2639, 8.1887, 8.1508],
        [9.0541, 8.8004, 8.5838, 8.3894, 8.2999, 8.2394, 8.1903]],

       [[8.2178, 7.9845, 7.7886, 7.6181, 7.5259, 7.4642, 7.4355],
        [8.3436, 8.1163, 7.9272, 7.7659, 7.686 , 7.6341, 7.5912],
        [8.4381, 8.2173, 8.0271, 7.8726, 7.7881, 7.7363, 7.7046],
        [   8.55, 8.2995, 8.1081, 7.9538, 7.8671, 7.812 , 7.7709],
        [   8.65, 8.3807, 8.1855, 8.0178, 7.9313, 7.8829, 7.8373],
        [8.7013, 8.4445, 8.2528, 8.0779, 7.9822, 7.9306, 7.8975],
        [8.7336, 8.4991, 8.3038, 8.1378, 8.0441, 7.9808, 7.9399],
        [8.764 , 8.566 , 8.363 , 8.1827, 8.092 , 8.0376, 7.9845],
        [8.8729, 8.617 , 8.4098, 8.227 , 8.1377, 8.073 , 8.0311],
        [8.9138, 8.6634, 8.4586, 8.2746, 8.1929, 8.1136, 8.0722],
        [8.9746, 8.7196, 8.5086, 8.3231, 8.2327, 8.1577, 8.1185]],

       [[8.1498, 7.893 , 7.7013, 7.5264, 7.4339, 7.3791, 7.346 ],
        [   8.25, 8.0213, 7.8409, 7.6789, 7.5889, 7.5338, 7.4927],
        [   8.35, 8.1328, 7.9414, 7.7889, 7.6927, 7.6408, 7.601 ],
        [   8.45, 8.2039, 8.0235, 7.868 , 7.7725, 7.7229, 7.6831],
        [8.5293, 8.2971, 8.1034, 7.9354, 7.8442, 7.7923, 7.7525],
        [8.6123, 8.3645, 8.1638, 7.9956, 7.8964, 7.8449, 7.7888],
        [8.6487, 8.4143, 8.2256, 8.0529, 7.957 , 7.8959, 7.8595],
        [8.6837, 8.4857, 8.2828, 8.1024, 8.0117, 7.9574, 7.9043],
        [8.7845, 8.5396, 8.3257, 8.1518, 8.0593, 7.9945, 7.9515],
        [8.8418, 8.5936, 8.3799, 8.2003, 8.1076, 8.0361, 8.0032],
        [8.895 , 8.6401, 8.4266, 8.2491, 8.1686, 8.0893, 8.0434]]])



logrho_vpower75 = np.array([[[8.4961, 8.3048, 8.1505, 8.0087, 7.9469, 7.9053, 7.8744],
        [8.6329, 8.4554, 8.2999, 8.1758, 8.1042, 8.0681, 8.0517],
        [8.7391, 8.5638, 8.406 , 8.2784, 8.2103, 8.1742, 8.1578],
        [8.8286, 8.6474, 8.4973, 8.361 , 8.2917, 8.2524, 8.2215],
        [8.8903, 8.7221, 8.5599, 8.4216, 8.3521, 8.31  , 8.2763],
        [8.9682, 8.7855, 8.6106, 8.4665, 8.3915, 8.3498, 8.3215],
        [9.0193, 8.8374, 8.6612, 8.5197, 8.4422, 8.3951, 8.3639],
        [9.084 , 8.8856, 8.7149, 8.5704, 8.4806, 8.4308, 8.3934],
        [   9.14, 8.9354, 8.75  , 8.6066, 8.5132, 8.4646, 8.433 ],
        [   9.19, 8.9802, 8.7888, 8.6333, 8.5478, 8.496 , 8.4517],
        [9.2394, 9.0269, 8.8344, 8.6861, 8.583 , 8.5311, 8.4913]],

       [[8.4278, 8.2596, 8.0974, 7.959 , 7.8895, 7.8474, 7.8138],
        [8.5825, 8.397 , 8.2547, 8.1162, 8.0468, 8.0107, 7.9799],
        [8.6888, 8.5165, 8.3543, 8.2257, 8.1531, 8.117 , 8.0861],
        [8.7831, 8.5917, 8.4407, 8.2989, 8.2326, 8.1922, 8.1613],
        [8.8565, 8.6718, 8.5038, 8.3608, 8.2935, 8.2406, 8.2167],
        [8.9195, 8.731 , 8.5606, 8.4068, 8.3403, 8.2954, 8.2985],
        [8.9899, 8.787 , 8.6111, 8.4559, 8.3788, 8.3335, 8.2961],
        [9.0412, 8.8297, 8.6611, 8.5013, 8.4256, 8.3815, 8.3386],
        [   9.1, 8.8807, 8.6995, 8.545 , 8.465 , 8.4132, 8.3803],
        [   9.15, 8.9178, 8.7374, 8.5874, 8.5009, 8.4458, 8.4114],
        [9.2006, 8.9749, 8.7901, 8.6252, 8.5424, 8.4757, 8.4425]],

       [[8.3899, 8.2052, 8.0414, 7.8919, 7.8269, 7.7785, 7.7533],
        [8.538 , 8.3511, 8.2031, 8.0505, 7.9909, 7.9471, 7.9162],
        [8.6489, 8.4576, 8.2988, 8.1615, 8.0952, 8.0581, 8.0227],
        [8.737 , 8.537 , 8.3785, 8.2481, 8.1786, 8.1223, 8.0984],
        [8.8044, 8.6216, 8.4467, 8.3027, 8.2277, 8.186 , 8.1576],
        [8.8637, 8.6817, 8.5023, 8.3496, 8.2865, 8.2394, 8.2083],
        [8.9272, 8.7355, 8.5527, 8.4203, 8.3261, 8.2696, 8.2401],
        [   8.99, 8.7806, 8.6041, 8.4563, 8.3674, 8.3188, 8.2826],
        [   9.05, 8.8375, 8.6461, 8.4918, 8.4051, 8.35  , 8.309 ],
        [9.0997, 8.8873, 8.6903, 8.5465, 8.4388, 8.3982, 8.3516],
        [9.1547, 8.9304, 8.7387, 8.5705, 8.4758, 8.4242, 8.3781]],

       [[8.3417, 8.1501, 7.9886, 7.8388, 7.7606, 7.7189, 7.6905],
        [8.4832, 8.2921, 8.1371, 7.9987, 7.9292, 7.8871, 7.8535],
        [8.5989, 8.3989, 8.2417, 8.11  , 8.0405, 7.9842, 7.9603],
        [8.6808, 8.496 , 8.3311, 8.1771, 8.1053, 8.0637, 8.0353],
        [8.758 , 8.5671, 8.3901, 8.2441, 8.1743, 8.1282, 8.0993],
        [8.8279, 8.625 , 8.4478, 8.2983, 8.2212, 8.1715, 8.1385],
        [8.8872, 8.6824, 8.5049, 8.3417, 8.2694, 8.2253, 8.1856],
        [   8.95, 8.738 , 8.5478, 8.3966, 8.3166, 8.2647, 8.2219],
        [9.0003, 8.7697, 8.6015, 8.4393, 8.356 , 8.3009, 8.2633],
        [9.056 , 8.8303, 8.6455, 8.4816, 8.4055, 8.3298, 8.2979],
        [9.1233, 8.8754, 8.6935, 8.5166, 8.4239, 8.366 , 8.3296]],

       [[8.2847, 8.0983, 7.9234, 7.7773, 7.7044, 7.656 , 7.6119],
        [8.4308, 8.246 , 8.081 , 7.9271, 7.8553, 7.8136, 7.7852],
        [8.538 , 8.3533, 8.1848, 8.0376, 7.9625, 7.9209, 7.897 ],
        [8.6296, 8.4412, 8.2707, 8.1255, 8.0539, 8.0011, 8.0087],
        [8.7119, 8.51  , 8.3386, 8.1868, 8.116 , 8.0689, 8.0248],
        [8.7731, 8.5704, 8.3953, 8.2473, 8.1687, 8.1078, 8.0783],
        [   8.84, 8.6262, 8.4408, 8.2873, 8.2073, 8.1599, 8.127 ],
        [   8.9, 8.6791, 8.4987, 8.34  , 8.2545, 8.1994, 8.1583],
        [8.9455, 8.733 , 8.5483, 8.3803, 8.2923, 8.2305, 8.2019],
        [9.037 , 8.7802, 8.6007, 8.4303, 8.3333, 8.2818, 8.2356],
        [9.0578, 8.8234, 8.637 , 8.462 , 8.3815, 8.3093, 8.2729]],

       [[8.242 , 8.0336, 7.863 , 7.7102, 7.6331, 7.5878, 7.5471],
        [8.3732, 8.1913, 8.0144, 7.8638, 7.7941, 7.7492, 7.7191],
        [8.4901, 8.2992, 8.1222, 7.9717, 7.902 , 7.857 , 7.8269],
        [8.5603, 8.3848, 8.2111, 8.0651, 7.9876, 7.9393, 7.8951],
        [8.6526, 8.4542, 8.2701, 8.139 , 8.0492, 7.9883, 7.962 ],
        [   8.72, 8.513 , 8.3365, 8.1788, 8.0953, 8.0512, 8.015 ],
        [   8.79, 8.5798, 8.3884, 8.2297, 8.1474, 8.0923, 8.0513],
        [8.8475, 8.6283, 8.4403, 8.2887, 8.1888, 8.1482, 8.1016],
        [8.9035, 8.687 , 8.4953, 8.3271, 8.2324, 8.1808, 8.1347],
        [8.967 , 8.728 , 8.5439, 8.3712, 8.2897, 8.2219, 8.181 ],
        [8.9907, 8.7928, 8.5898, 8.4139, 8.3265, 8.2542, 8.2123]],

       [[8.1832, 7.9785, 7.8009, 7.6377, 7.5654, 7.5213, 7.4817],
        [8.3249, 8.1309, 7.955 , 7.7921, 7.7083, 7.6841, 7.64  ],
        [8.4336, 8.2396, 8.0637, 7.9053, 7.817 , 7.7929, 7.7487],
        [8.5218, 8.3234, 8.1393, 8.0082, 7.9184, 7.8575, 7.8312],
        [   8.6, 8.3957, 8.2191, 8.0636, 7.9747, 7.9306, 7.8976],
        [   8.67, 8.4656, 8.2787, 8.1275, 8.03  , 7.9782, 7.9371],
        [8.7364, 8.5237, 8.3237, 8.1698, 8.0765, 8.0381, 7.9938],
        [8.8006, 8.5773, 8.3946, 8.2197, 8.1272, 8.0757, 8.0195],
        [8.8692, 8.6303, 8.4394, 8.2734, 8.1775, 8.1197, 8.0833],
        [8.8958, 8.6889, 8.486 , 8.3145, 8.2283, 8.1628, 8.113 ],
        [8.9233, 8.7386, 8.5301, 8.3563, 8.2748, 8.2162, 8.1636]],

       [[   8.12, 7.9197, 7.7395, 7.5815, 7.4898, 7.4267, 7.4036],
        [8.2676, 8.0626, 7.8875, 7.7298, 7.653 , 7.6   , 7.5693],
        [8.3775, 8.1725, 7.9974, 7.8397, 7.7629, 7.7099, 7.6792],
        [   8.48, 8.2592, 8.0827, 7.9361, 7.8415, 7.7973, 7.7612],
        [   8.56, 8.3427, 8.1558, 8.0045, 7.9071, 7.8552, 7.8142],
        [8.6214, 8.4087, 8.2087, 8.0547, 7.9682, 7.9186, 7.8743],
        [8.6911, 8.4678, 8.2786, 8.1102, 8.0177, 7.9674, 7.91  ],
        [8.764 , 8.525 , 8.3342, 8.1682, 8.0722, 8.0112, 7.9735],
        [8.7941, 8.5861, 8.3842, 8.2128, 8.1265, 8.061 , 8.0112],
        [8.825 , 8.6402, 8.4318, 8.2579, 8.1719, 8.1084, 8.0653],
        [8.9205, 8.6867, 8.4818, 8.3067, 8.225 , 8.1489, 8.1043]],

       [[8.0719, 7.8662, 7.6692, 7.5134, 7.4177, 7.3771, 7.3305],
        [   8.12, 8.0078, 7.8177, 7.6664, 7.5864, 7.5313, 7.4917],
        [   8.22, 8.1104, 7.9292, 7.7747, 7.6947, 7.6429, 7.6032],
        [   8.35, 8.2039, 8.0125, 7.8615, 7.776 , 7.7197, 7.6786],
        [8.4984, 8.2792, 8.0912, 7.9396, 7.8397, 7.7868, 7.7492],
        [8.5698, 8.3466, 8.1638, 7.9889, 7.8964, 7.8449, 7.8032],
        [8.6487, 8.4098, 8.2189, 8.0529, 7.967 , 7.8992, 7.8628],
        [8.6837, 8.4768, 8.2761, 8.1024, 8.015 , 7.9506, 7.9053],
        [8.7189, 8.5341, 8.3257, 8.1518, 8.0703, 8.0117, 7.9592],
        [8.8186, 8.5849, 8.3799, 8.2048, 8.1231, 8.047 , 8.0069],
        [8.8641,    8.64, 8.4356, 8.2513, 8.1686, 8.0935, 8.0589]]])

c0_values = np.array([0.5, 1., 2., 4., 6, 8, 10.])
redshifts = [0, 0.3, 0.6, 0.9, 1.2, 1.5, 1.8, 2.1, 2.4,
             2.7, 3.0]
mass_values = [6, 6.5, 7., 7.5, 8., 8.5, 9, 9.5, 10]

values = np.stack((logrho_vpower0, logrho_vpower25, logrho_vpower50, logrho_vpower75))
v_dependence = [0., 0.25, 0.5, 0.75]
points = (v_dependence, mass_values, redshifts, c0_values)
interp = RegularGridInterpolator(points, values)

def logrho(log_mass, z, c0, v_dep, delta_concentration,
            concentration_scatter_scale=0.3):
    """

    Returns the central density of an SIDM halo with an interaction cross section parameterized as:

    sigma(v) = sigma_0 * (30 / v) ^ v_dep

    :param log_mass: log(halo mass), mass definition m_200 (no little h)
    :param z: halo redshift
    :param c0: self interacction cross section at 30 km/sec
    :param v_dep: velocity dependence of cross section
    :param delta_concentration: fractional deviation from the median halo concentration with respect to
    the m-c relation of Diemer and Joyce (2019)
    :param concentration_scatter_scale: tunes the relationship between the scatter in the m-c relation and the
    scatter on the central density. 0.3 (dex) gives a good approximation

    :return: log(rho), where rho is the central density of the SIDM halo
    """

    if v_dep < 0:
        raise Exception('velocity dep must be >= 0.')
    elif v_dep > 0.75:
        raise Exception('velocity dep must be <= 0.75')

    if c0 < c0_values[0]:
        c0 = c0_values[0]
    elif c0 > c0_values[-1]:
        c0 = c0_values[-1]

    if log_mass < 6 or log_mass > 10:
        raise Exception('log_mass must be between 6 and 10')

    xi = (v_dep, log_mass, z, c0)

    log_rho = interp(xi)

    log_rho += delta_concentration * concentration_scatter_scale

    return log_rho
